<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>EDU HACK '26 | Supreme Console</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Rubik+Glitch&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
  :root {
    --st-red: #ff0033;
    --st-green: #00e676;
    --st-blue: #00ccff;
    --st-orange: #ffab00;
    --bg-dark: #050505;
    --glass-surface: rgba(20, 20, 20, 0.9);
    --glass-border: rgba(255, 255, 255, 0.1);
    --text-primary: #e0e0e0;
    --text-secondary: #86868b;
    --font-main: 'JetBrains Mono', monospace;
    --font-title: 'Rubik Glitch', cursive;
  }

  * { box-sizing: border-box; outline: none; }

  body {
    margin: 0; font-family: var(--font-main); background-color: var(--bg-dark);
    color: var(--text-primary); min-height: 100vh;
    background: radial-gradient(circle at 50% -20%, #1a0505 0%, #000 80%);
  }

  /* SCANLINE EFFECT */
  body::before {
    content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
    background-size: 100% 4px; z-index: 100; pointer-events: none;
  }

  /* WORLD-CLASS BROADCAST BAR */
  .broadcast-bar {
    background: var(--st-red); color: white; padding: 10px; font-size: 0.8rem;
    text-align: center; font-weight: bold; letter-spacing: 2px;
    animation: pulse-red 2s infinite; position: sticky; top: 0; z-index: 1000;
  }
  @keyframes pulse-red { 0% { opacity: 0.9; } 50% { opacity: 1; } 100% { opacity: 0.9; } }

  .app-container {
    max-width: 1200px; margin: 0 auto; padding: 20px; position: relative; z-index: 10;
    display: none; opacity: 0; transition: 1s ease; padding-bottom: 120px;
  }
  .app-container.visible { display: block; opacity: 1; }

  .login-screen {
    position: fixed; inset: 0; z-index: 2000; display: flex; flex-direction: column;
    align-items: center; justify-content: center; background: #000; transition: 0.8s;
  }
  .login-screen.hidden { transform: translateY(-100%); opacity: 0; pointer-events: none; }

  .glitch-logo {
    font-family: var(--font-title); font-size: 5rem; color: #fff;
    text-shadow: 4px 4px 0px var(--st-red); margin-bottom: 20px;
    animation: glitch 2.5s infinite alternate-reverse; line-height: 1;
  }

  header { border-bottom: 1px solid var(--glass-border); margin-bottom: 30px; padding-bottom: 20px; }

  .tabs { display: flex; gap: 2px; margin-bottom: 30px; background: rgba(255,255,255,0.05); padding: 4px; border-radius: 6px; }
  .tab-btn {
    flex: 1; background: transparent; border: none; color: var(--text-secondary);
    font-family: var(--font-main); font-size: 0.8rem; font-weight: 700;
    padding: 16px; cursor: pointer; transition: 0.3s; text-transform: uppercase;
  }
  .tab-btn.active { color: #000; background: #fff; box-shadow: 0 0 15px rgba(255,255,255,0.3); }

  .glass-card {
    background: var(--glass-surface); backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border); padding: 30px; margin-bottom: 24px;
    position: relative;
  }
  .glass-card::before { content:''; position: absolute; top:0; left:0; width: 4px; height: 100%; background: var(--st-red); }

  /* PROGRESS BAR */
  .progress-container { height: 10px; background: #222; border-radius: 5px; margin: 20px 0; overflow: hidden; }
  .progress-fill { height: 100%; background: var(--st-green); width: 0%; transition: 1s ease; box-shadow: 0 0 10px var(--st-green); }

  input {
    background: #111; border: 1px solid #333; color: var(--st-green);
    padding: 12px 18px; font-family: var(--font-main); width: 100%; margin-bottom: 10px;
  }

  .btn {
    background: var(--st-red); color: #fff; border: none; padding: 12px 24px;
    font-weight: 700; cursor: pointer; width: 100%; font-family: var(--font-main);
    clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
  }
  .btn:hover { background: #ff3355; box-shadow: 0 0 15px rgba(255, 0, 51, 0.4); }
  .btn:disabled { background: #333; color: #888; cursor: not-allowed; }

  .problem-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px; max-height: 500px; overflow-y: auto; padding-right: 10px;
  }
  .prob-card {
    background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border); padding: 15px;
    position: relative; transition: 0.3s; cursor: pointer;
  }
  .prob-card.locked { opacity: 0.4; border-color: var(--st-red); }
  .prob-card:hover:not(.locked) { border-color: var(--st-blue); background: rgba(0, 204, 255, 0.05); }

  .mentor-btn {
    position: fixed; bottom: 30px; right: 30px; background: var(--st-orange);
    width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
    box-shadow: 0 0 20px rgba(255, 171, 0, 0.4); cursor: pointer; z-index: 999; border: none;
  }

  .timer-display { font-family: var(--font-title); font-size: 5rem; color: #fff; text-shadow: 0 0 20px rgba(255,0,51,0.6); margin: 20px 0; }

  .resource-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
  .res-link { background: rgba(255,255,255,0.05); padding: 10px; text-decoration: none; color: var(--st-blue); font-size: 0.7rem; border: 1px solid #333; text-align: center; }
  .res-link:hover { background: var(--st-blue); color: #000; }

  @media(max-width: 768px){ .glitch-logo { font-size: 3rem; } .timer-display { font-size: 3rem; } .resource-grid { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<div class="broadcast-bar" id="broadcast">SYSTEM MESSAGE: HACKATHON COMMENCING SOON. PREPARE YOUR TEAMS.</div>

<button class="mentor-btn" onclick="callMentor()">
    <span class="material-icons">support_agent</span>
</button>

<div class="login-screen" id="loginScreen">
  <div class="glitch-logo">EDU HACK<br>SUPREME</div>
  <button class="btn" style="width:auto; min-width:280px; background:#fff; color:#000;" id="loginBtn">AUTHENTICATE ACCESS</button>
</div>

<div class="app-container" id="appContainer">
  
  <header>
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
      <div>
        <h1 style="margin:0; font-size:1.8rem; letter-spacing:-1px;">EDUHACK<span style="color:var(--st-red)"> SUPREME</span></h1>
        <span style="font-size:0.75rem; color:var(--text-secondary);">10X CLUB | KARE CAMPUS</span>
      </div>
      <div class="user-badge">
        <div class="user-avatar" id="userAvatar"></div>
        <div>
          <div id="userName" style="font-weight:700;">USER_ALPHA</div>
          <div style="font-size:0.7rem; color:var(--st-green);">TEAM: <span id="teamNameDisplay">...</span></div>
        </div>
      </div>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab-btn active" onclick="switchTab('hackathon')">Mission Dashboard</button>
    <button class="tab-btn" onclick="switchTab('problems')">Problem Matrix</button>
    <button class="tab-btn" onclick="switchTab('resources')">Resources</button>
    <button class="tab-btn" onclick="switchTab('timeline')">Mission Log</button>
  </nav>

  <div id="hackathon" class="show-section">
    <div style="text-align:center; margin-bottom:30px;">
      <div id="timerLabel" style="font-size:0.8rem; letter-spacing:4px; color:var(--st-red);">REMAINING TIME</div>
      <div class="timer-display" id="timer">00:00:00:00</div>
      
      <div style="max-width: 600px; margin: 0 auto;">
          <div style="display:flex; justify-content: space-between; font-size: 0.7rem; margin-bottom: 5px;">
              <span>MISSION PROGRESS</span>
              <span id="progressPercent">0%</span>
          </div>
          <div class="progress-container"><div class="progress-fill" id="progressFill"></div></div>
      </div>
    </div>

    <div class="glass-card">
      <h3 style="color:var(--st-green); margin-top:0;">1. PROTOCOL ACTIVATION</h3>
      <div style="display: grid; grid-template-columns: 1fr 2fr auto; gap: 10px;">
          <input type="number" id="projectTopic" placeholder="Problem ID (1-50)">
          <input type="text" id="projectTitle" placeholder="Your Unique Project Title...">
          <button class="btn" id="freezeBtn">LOCK DATA</button>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div class="glass-card">
            <h3 style="color:var(--st-orange);">ROUND 1: PLANNING</h3>
            <input type="text" id="round1Link" placeholder="Slide Deck Link (Google Drive)">
            <button class="btn" id="btnRound1" onclick="submitRound1()">SUBMIT PLANNING</button>
        </div>
        <div class="glass-card">
            <h3 style="color:var(--st-blue);">FINAL: DEPLOYMENT</h3>
            <input type="text" id="finalGithub" placeholder="GitHub Repository">
            <input type="text" id="finalPPT" placeholder="Final Presentation Link">
            <button class="btn" id="btnFinalRound" onclick="submitFinalRound()">FINALIZE MISSION</button>
        </div>
    </div>
  </div>

  <div id="problems" class="hidden-section">
    <div class="glass-card">
        <h2 style="color:var(--st-blue); margin-top:0;">PROBLEM MATRIX</h2>
        <div class="problem-grid" id="problemList"></div>
    </div>
  </div>

  <div id="resources" class="hidden-section">
      <div class="glass-card">
          <h2 style="color:var(--st-orange);">DEVELOPER TOOLKIT</h2>
          <div class="resource-grid">
              <a href="#" class="res-link">Angular Official Docs</a>
              <a href="#" class="res-link">Firebase Console</a>
              <a href="#" class="res-link">Tailwind Cheat Sheet</a>
              <a href="#" class="res-link">Material Icons List</a>
              <a href="#" class="res-link">Devpost Best Practices</a>
              <a href="#" class="res-link">Github Desktop Tool</a>
          </div>
      </div>
  </div>

  <div id="timeline" class="hidden-section">
      <div class="glass-card">
          <h2 style="color:var(--st-red);">MISSION LOG</h2>
          <div id="logContent" style="font-size: 0.85rem; line-height: 2;">
              </div>
      </div>
  </div>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, query, getDocs, doc, updateDoc, serverTimestamp, onSnapshot, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBzEwEDcTDs2Y-NUAGZkhQJsFRg6MZxoYE",
    authDomain: "eduhack-432fd.firebaseapp.com",
    projectId: "eduhack-432fd",
    storageBucket: "eduhack-432fd.firebasestorage.app",
    messagingSenderId: "160252785408",
    appId: "1:160252785408:web:6a22e465982e3e510979e5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();
  const EVENT_ID = "edu-hack-2025";
  const DATE_START = new Date("Jan 30, 2026 17:00:00").getTime(); 
  const DATE_END = new Date("Jan 31, 2026 17:00:00").getTime(); 

  let currentTeamId = null;
  let currentUser = null;
  let stats = {};

  const problems = [
    "Predictive Attendance Risk Analyzer", "Smart Academic Alert Notification", "Automated Transcript Request Workflow",
    "Unified Campus Portal SSO", "Intelligent Exam Seating Allocation", "Attendance Anomaly Detection System",
    "Faculty Load Distribution Dashboard", "Personalized Elective Recommendation", "Virtual SIS Helpdesk Chatbot",
    "KAFKA Complaint Trend Analytics", "Hostel Maintenance Priority System", "Hostel Occupancy Prediction Simulator",
    "Smart Grievance Escalation Engine", "Mobile Complaint Tracking Interface", "Multilingual Portal Accessibility Layer",
    "Hostel Utility Consumption Platform", "Smart Campus Bus Route Optimizer", "Real-Time Transport Tracking Simulator",
    "Campus Emergency Broadcast System", "Exam Timetable Clash Detection", "Smart Lab Resource Booking Platform",
    "Peer Mentoring Matchmaking Engine", "Digital Academic Certificate Verification", "Student Feedback Sentiment Tool",
    "Automated Leave Approval Engine", "Smart Canteen Crowd Prediction", "Lab Utilization Optimization System",
    "Unified University Events Calendar", "Student Skill Gap Identification", "LMS Engagement Analytics Dashboard",
    "Scholarship Eligibility Filtering", "Intelligent Notification Controller", "Centralized Campus Grievance Console",
    "Document Digitization & OCR Tool", "Dynamic University FAQ Generator", "Campus Occupancy Visualization Heatmap",
    "Night Transport Safety Monitoring", "Academic Performance Forecasting", "Alumni Mentorship Matching Platform",
    "Interactive Portal Guidance Assistant", "Hostel Food Quality Analytics", "Smart Hostel Energy Optimization",
    "Campus Data Privacy Risk Scanner", "Degree Progress Audit Automation", "System Downtime Notification Simulator",
    "Third-Party Tool Integration Gateway", "Student Certification Tracking", "Counseling Appointment Queue Manager",
    "Accessibility Enhancement Toolkit", "University KPI Analytics Dashboard"
  ];

  const missionLog = [
    {t: "JAN 30 5:00 PM", e: "HACKATHON START"},
    {t: "6:00PM - 6:30PM", e: "Problem Distribution"},
    {t: "8:15PM - 9:00PM", e: "Round 1 Submission Deadline"},
    {t: "11:00PM - 3:00AM", e: "Phase 1 Development"},
    {t: "JAN 31 10:00 AM", e: "Phase 2 Development"},
    {t: "3:30PM - 4:00PM", e: "Final Submission Deadline"},
    {t: "5:00 PM", e: "Winners Announcement"}
  ];

  // INIT UI
  const logDiv = document.getElementById('logContent');
  missionLog.forEach(l => logDiv.innerHTML += `<div><span style="color:var(--st-blue)">${l.t}</span> â€” ${l.e}</div>`);

  // AUTH
  document.getElementById('loginBtn').onclick = () => signInWithPopup(auth, provider);

  onAuthStateChanged(auth, async (user) => {
      if(user) {
          const snap = await getDocs(collection(db, "events", EVENT_ID, "registrations"));
          let myTeam = null;
          snap.forEach(doc => {
              const data = doc.data();
              const members = data.members || [];
              const isMember = members.some(m => (typeof m === 'string' ? m : m.email).toLowerCase() === user.email.toLowerCase());
              if(isMember && data.verified) { myTeam = data; currentTeamId = doc.id; }
          });

          if(myTeam) {
              currentUser = user;
              document.getElementById('loginScreen').classList.add('hidden');
              document.getElementById('appContainer').classList.add('visible');
              document.getElementById('userName').textContent = user.displayName;
              document.getElementById('teamNameDisplay').textContent = myTeam.team_name.toUpperCase();
              if(user.photoURL) document.getElementById('userAvatar').style.backgroundImage = `url(${user.photoURL})`;
              syncStats();
              loadDash(myTeam.submissions || {});
          } else {
              alert("Access Denied: Unverified Identity."); signOut(auth);
          }
      }
  });

  function syncStats() {
      onSnapshot(collection(db, "events", EVENT_ID, "registrations"), (snapshot) => {
          stats = {};
          snapshot.forEach(doc => {
              const topic = doc.data().submissions?.projectTopic;
              if(topic) stats[topic] = (stats[topic] || 0) + 1;
          });
          renderProbs();
      });
  }

  function renderProbs() {
      const list = document.getElementById('problemList');
      list.innerHTML = "";
      problems.forEach((p, i) => {
          const id = i + 1;
          const count = stats[id] || 0;
          const card = document.createElement('div');
          card.className = `prob-card ${count >= 2 ? 'locked' : ''}`;
          card.innerHTML = `<span style="font-size:0.6rem; color:var(--st-orange);">${count}/2 CLAIMED</span><br><b>#${id}</b> ${p}`;
          list.appendChild(card);
      });
  }

  function loadDash(s) {
      let progress = 0;
      if(s.projectTopic) {
          document.getElementById('projectTopic').value = s.projectTopic;
          document.getElementById('projectTitle').value = s.projectTitle;
          ['projectTopic','projectTitle','freezeBtn'].forEach(id => document.getElementById(id).disabled = true);
          progress += 33;
      }
      if(s.round1Link) { document.getElementById('round1Link').value = s.round1Link; disableBtn('btnRound1'); progress += 33; }
      if(s.finalGithub) { 
          document.getElementById('finalGithub').value = s.finalGithub; 
          document.getElementById('finalPPT').value = s.finalPPT; 
          disableBtn('btnFinalRound'); progress = 100;
      }
      document.getElementById('progressFill').style.width = progress + "%";
      document.getElementById('progressPercent').textContent = progress + "%";
  }

  document.getElementById('freezeBtn').onclick = async () => {
      const id = parseInt(document.getElementById('projectTopic').value);
      const title = document.getElementById('projectTitle').value;
      if(!id || !title || id < 1 || id > 50) return alert("Invalid Data.");
      if((stats[id] || 0) >= 2) return alert("Problem already claimed by 2 teams.");
      
      await updateDoc(doc(db, "events", EVENT_ID, "registrations", currentTeamId), {
          "submissions.projectTopic": id, "submissions.projectTitle": title
      });
      location.reload();
  };

  window.submitRound1 = async () => {
      const link = document.getElementById('round1Link').value;
      if(link) {
          await updateDoc(doc(db, "events", EVENT_ID, "registrations", currentTeamId), { "submissions.round1Link": link });
          location.reload();
      }
  };

  window.submitFinalRound = async () => {
      const git = document.getElementById('finalGithub').value;
      const ppt = document.getElementById('finalPPT').value;
      if(git && ppt) {
          await updateDoc(doc(db, "events", EVENT_ID, "registrations", currentTeamId), { "submissions.finalGithub": git, "submissions.finalPPT": ppt });
          location.reload();
      }
  };

  window.callMentor = async () => {
      const loc = prompt("Where are you sitting? (e.g. Block 8, Lab 2)");
      if(loc) {
          await addDoc(collection(db, "mentor_requests"), { team: currentTeamId, location: loc, time: serverTimestamp() });
          alert("MENTOR SIGNAL BROADCASTED.");
      }
  };

  window.switchTab = (id) => {
      document.querySelectorAll('.show-section').forEach(e => e.className = 'hidden-section');
      document.getElementById(id).className = 'show-section';
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
  };

  function disableBtn(id) { const b = document.getElementById(id); b.disabled = true; b.textContent = "DONE"; b.style.color = "var(--st-green)"; }

  setInterval(() => {
    const now = new Date().getTime();
    let dist, label;
    if (now < DATE_START) { dist = DATE_START - now; label = "COMMENCES IN"; }
    else if (now < DATE_END) { dist = DATE_END - now; label = "TIME REMAINING"; document.getElementById('timer').style.color = "var(--st-green)"; }
    else { document.getElementById('timer').textContent = "OFFLINE"; return; }
    const h = Math.floor(dist / 3600000);
    const m = Math.floor((dist % 3600000) / 60000);
    const s = Math.floor((dist % 60000) / 1000);
    document.getElementById('timer').textContent = `${h}h ${m}m ${s}s`;
    document.getElementById('timerLabel').textContent = label;
  }, 1000);
</script>
</body>
</html>
